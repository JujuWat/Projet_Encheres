<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Détails de l'objet</title>
<link rel="stylesheet" th:href="@{/css/style.css}" />
<link rel="stylesheet" th:href="@{/css/details.css}" />
</head>
<body>
<div th:replace="~{fragments/entete::entete}"></div>


	<form action="/encheres/detailsobjet" method="post" > 
	
	<div>
    <!-- Message de succès -->
    <div th:if="${successMessage}" class="success-message">
        <p th:text="${successMessage}"></p>
    </div>

    <!-- Message d'erreur -->
    <div th:if="${errorMessage}" class="error-message">
        <p th:text="${errorMessage}"></p>
    </div>
	</div>

	<input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
	<input type="hidden" name="id" th:value="${detailsarticle.noArticle}" />
	<h1>Détails de l'objet</h1>
	<ul>
	
		<li>
			<label for ="image"></label>
			<div class = "vignette"><img alt="image de l'article" th:src = "${detailsarticle.imageUrl}" readonly/></div>
		</li>
		<li>
			<label for ="nom_article">Nom de l'article</label>
			<input id="nom_article" type="text" name="nom_article" th:field="${detailsarticle.nomArticle}" readonly/> 
		</li>
		<li>
			<label for ="description">Description</label>
			<input id="description" type="textarea" name="description" th:value="${detailsarticle.description}" readonly/> 
		</li>
		<li>
			<label for ="categorie">Catégorie</label>
			<input id="categorie" type="text" name="categorie" th:value="${libelle}" readonly/> 
		</li>
		<li>
			<label for ="prixVente">Meilleure offre</label>
			<input id="prixVente" type="text" name="prixVente" th:field="${detailsarticle.prixVente}" readonly/> 
			<!--  <input id="meilleurEncherisseur" type="text" name ="meilleurEncherisseur" th:field="${utilisateur.}" readonly> -->
		</li>
		<li>
			<label for ="miseAPrix">Mise à prix</label>
			<input id="miseAPrix" type="text" name="miseAPrix" th:field="${detailsarticle.miseAPrix}" readonly/> 
		</li>
		<li>
			<label for ="dateFinEncheres">Date de fin d'enchères</label>
			<input id="dateFinEncheres" type="text" name="dateFinEncheres" th:field="${detailsarticle.dateFinEncheres}" readonly/> 
		</li>
		<li>
			<label for ="retrait">Retrait</label>
			<input id="retrait" type="text" name="retrait" th:field="${retrait.rue}" readonly/> 
			<input id="retrait" type="text" name="retrait" th:field="${retrait.code_postal}" readonly/> 
			<input id="retrait" type="text" name="retrait" th:field="${retrait.ville}" readonly/> 
		</li>
		<li>
			<label for ="vendeur">Vendeur</label>
			<input id="vendeur" type="text" name="vendeur" th:field="${utilisateur.pseudo}" readonly/> 
		</li>
		
		<li>
			<label for="enchere">Votre enchère :</label>
			<input type="text" id="enchere" name="enchere" placeholder="Placez votre enchère" required="required">
		</li>
		<li>
			<button type ="submit">Enchérir</button>
		</li>
		
		
	</ul>
	</form>


<script>
    document.addEventListener("DOMContentLoaded", function () {
        const form = document.querySelector("form");
        const enchereInput = document.getElementById("enchere");
        const miseAPrixInput = document.getElementById("miseAPrix");
        const prixVenteInput = document.getElementById("prixVente");

        // Parse les valeurs des champs read-only
        const miseAPrix = parseFloat(miseAPrixInput.value);
        const prixVente = parseFloat(prixVenteInput.value);

        form.addEventListener("submit", function (event) {
            const enchere = parseFloat(enchereInput.value);

            if (isNaN(enchere) || enchere <= miseAPrix || enchere <= prixVente) {
                event.preventDefault(); // Empêche l'envoi du formulaire
                alert(
                    `Votre enchère doit être supérieure à la mise à prix (${miseAPrix}) et à la meilleure offre actuelle (${prixVente}) !`
                );
            }
        });
    });
</script>



</body>
</html>